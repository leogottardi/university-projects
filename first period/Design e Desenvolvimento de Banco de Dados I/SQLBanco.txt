CREATE TABLE  "CLIENTES" 
   (	"ID" NUMBER(*,0), 
	"EMAIL" VARCHAR2(50) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	"TELEFONE" VARCHAR2(50) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	 PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 UNIQUE ("TELEFONE")
  USING INDEX  ENABLE, 
	 UNIQUE ("EMAIL")
  USING INDEX  ENABLE
   )  DEFAULT COLLATION "USING_NLS_COMP"
/
CREATE TABLE  "CLIENTES_PF" 
   (	"ID" NUMBER(*,0), 
	"CPF" VARCHAR2(14) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	"NOME" VARCHAR2(50) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	"SOBRENOME" VARCHAR2(50) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	 PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 UNIQUE ("NOME", "SOBRENOME")
  USING INDEX  ENABLE, 
	 UNIQUE ("CPF")
  USING INDEX  ENABLE
   )  DEFAULT COLLATION "USING_NLS_COMP"
/
CREATE TABLE  "CLIENTES_PJ" 
   (	"ID" NUMBER(*,0), 
	"RAZAO_SOCIAL" VARCHAR2(50) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	"CNPJ" VARCHAR2(18) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	 PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 UNIQUE ("CNPJ")
  USING INDEX  ENABLE
   )  DEFAULT COLLATION "USING_NLS_COMP"
/
CREATE TABLE  "COMPRAS" 
   (	"ID" NUMBER(*,0), 
	"DATA" TIMESTAMP (6) NOT NULL ENABLE, 
	"VALOR" NUMBER(*,2) NOT NULL ENABLE, 
	"FUNCIONARIOS_ID" NUMBER(*,0) NOT NULL ENABLE, 
	"FORNECEDORES_ID" NUMBER(*,0) NOT NULL ENABLE, 
	 PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 UNIQUE ("DATA", "FUNCIONARIOS_ID")
  USING INDEX  ENABLE
   )  DEFAULT COLLATION "USING_NLS_COMP"
/
CREATE TABLE  "COMPRAS_PRODUTOS" 
   (	"QUANTIDADE" NUMBER(*,0) NOT NULL ENABLE, 
	"COMPRAS_ID" NUMBER(*,0) NOT NULL ENABLE, 
	"PRODUTOS_ID" NUMBER(*,0) NOT NULL ENABLE, 
	 CONSTRAINT "COMPRAS_PRODUTOS_UK" UNIQUE ("PRODUTOS_ID", "COMPRAS_ID")
  USING INDEX  ENABLE
   )  DEFAULT COLLATION "USING_NLS_COMP"
/
CREATE TABLE  "FORNECEDORES" 
   (	"ID" NUMBER(*,0), 
	"CNPJ" VARCHAR2(18) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	"RAZAO_SOCIAL" VARCHAR2(50) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	"NOME_FANTASIA" VARCHAR2(50) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	 PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 UNIQUE ("CNPJ")
  USING INDEX  ENABLE
   )  DEFAULT COLLATION "USING_NLS_COMP"
/
CREATE TABLE  "FUNCIONARIOS" 
   (	"ID" NUMBER(*,0), 
	"MATRICULA" NUMBER(*,0) NOT NULL ENABLE, 
	"NOME" VARCHAR2(50) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	"SOBRENOME" VARCHAR2(50) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	"CPF" VARCHAR2(14) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	"FUNCAO" VARCHAR2(50) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	 PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 UNIQUE ("MATRICULA")
  USING INDEX  ENABLE, 
	 UNIQUE ("NOME", "SOBRENOME")
  USING INDEX  ENABLE, 
	 CONSTRAINT "CPF_UK" UNIQUE ("CPF")
  USING INDEX  ENABLE
   )  DEFAULT COLLATION "USING_NLS_COMP"
/
CREATE TABLE  "ITENS" 
   (	"QUANTIDADE" NUMBER(*,0) NOT NULL ENABLE, 
	"SERVICOS_ID" NUMBER(*,0) NOT NULL ENABLE, 
	"PRODUTOS_ID" NUMBER(*,0) NOT NULL ENABLE, 
	 CONSTRAINT "ITENS_UK" UNIQUE ("PRODUTOS_ID", "SERVICOS_ID")
  USING INDEX  ENABLE
   )  DEFAULT COLLATION "USING_NLS_COMP"
/
CREATE TABLE  "PRODUTOS" 
   (	"ID" NUMBER(*,0) NOT NULL ENABLE, 
	"ITEM" VARCHAR2(50) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	"MARCA" VARCHAR2(50) COLLATE "USING_NLS_COMP" NOT NULL ENABLE,
	"VALOR" NUMBER(*,2) NOT NULL ENABLE, 
	"CATEGORIA" VARCHAR2(50) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	 PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 UNIQUE ("MARCA", "ITEM")
  USING INDEX  ENABLE
   )  DEFAULT COLLATION "USING_NLS_COMP"
/
CREATE TABLE  "SERVICOS" 
   (	"ID" NUMBER(*,0), 
	"DATA" TIMESTAMP (6) NOT NULL ENABLE, 
	"STATUS" VARCHAR2(32) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	"TIPO" VARCHAR2(50) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	"DURACAO" VARCHAR2(32) COLLATE "USING_NLS_COMP", 
	"VALOR" NUMBER(*,2) NOT NULL ENABLE, 
	"DESCONTO" NUMBER(*,2), 
	"AVALIACAO" NUMBER(*,0), 
	"VISTORIAS_ID" NUMBER(*,0) NOT NULL ENABLE, 
	 PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 UNIQUE ("DATA", "VISTORIAS_ID")
  USING INDEX  ENABLE
   )  DEFAULT COLLATION "USING_NLS_COMP"
/
CREATE TABLE  "TAREFAS" 
   (	"FUNCIONARIOS_ID" NUMBER(*,0) NOT NULL ENABLE, 
	"SERVICOS_ID" NUMBER(*,0) NOT NULL ENABLE, 
	 CONSTRAINT "TAREFAS_UK" UNIQUE ("FUNCIONARIOS_ID", "SERVICOS_ID")
  USING INDEX  ENABLE
   )  DEFAULT COLLATION "USING_NLS_COMP"
/
CREATE TABLE  "VEICULOS" 
   (	"ID" NUMBER(*,0), 
	"PLACA" VARCHAR2(8) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	"MARCA" VARCHAR2(50) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	"MODELO" VARCHAR2(50) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	"VERSAO" VARCHAR2(50) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	"KM" NUMBER(*,0) NOT NULL ENABLE, 
	"CLIENTES_ID" NUMBER(*,0) NOT NULL ENABLE, 
	 PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 UNIQUE ("PLACA")
  USING INDEX  ENABLE
   )  DEFAULT COLLATION "USING_NLS_COMP"
/
CREATE TABLE  "VISTORIAS" 
   (	"ID" NUMBER(*,0) NOT NULL ENABLE, 
	"ORDEM_SERVICO" NUMBER(*,0) NOT NULL ENABLE, 
	"DATA" TIMESTAMP (6) NOT NULL ENABLE, 
	"DESCRICAO" VARCHAR2(200) COLLATE "USING_NLS_COMP" NOT NULL ENABLE, 
	"VEICULOS_ID" NUMBER(*,0) NOT NULL ENABLE, 
	"FUNCIONARIOS_ID" NUMBER(*,0) NOT NULL ENABLE, 
	 PRIMARY KEY ("ID")
  USING INDEX  ENABLE, 
	 UNIQUE ("ORDEM_SERVICO")
  USING INDEX  ENABLE
   )  DEFAULT COLLATION "USING_NLS_COMP"
/
ALTER TABLE  "VISTORIAS" ADD CONSTRAINT "FK_VEICULOS" FOREIGN KEY ("VEICULOS_ID")
	  REFERENCES  "VEICULOS" ("ID") ENABLE
/
ALTER TABLE  "VISTORIAS" ADD CONSTRAINT "FK_FUNCIONARIOS" FOREIGN KEY ("FUNCIONARIOS_ID")
	  REFERENCES  "FUNCIONARIOS" ("ID") ENABLE
/
ALTER TABLE  "TAREFAS" ADD FOREIGN KEY ("FUNCIONARIOS_ID")
	  REFERENCES  "FUNCIONARIOS" ("ID") ENABLE
/
ALTER TABLE  "TAREFAS" ADD FOREIGN KEY ("SERVICOS_ID")
	  REFERENCES  "SERVICOS" ("ID") ENABLE
/
ALTER TABLE  "CLIENTES_PF" ADD FOREIGN KEY ("ID")
	  REFERENCES  "CLIENTES" ("ID") ENABLE
/
ALTER TABLE  "CLIENTES_PJ" ADD FOREIGN KEY ("ID")
	  REFERENCES  "CLIENTES" ("ID") ENABLE
/
ALTER TABLE  "COMPRAS" ADD FOREIGN KEY ("FUNCIONARIOS_ID")
	  REFERENCES  "FUNCIONARIOS" ("ID") ENABLE
/
ALTER TABLE  "COMPRAS" ADD CONSTRAINT "FK_FORNECEDORES" FOREIGN KEY ("FORNECEDORES_ID")
	  REFERENCES  "FORNECEDORES" ("ID") ENABLE
/
ALTER TABLE  "ITENS" ADD FOREIGN KEY ("SERVICOS_ID")
	  REFERENCES  "SERVICOS" ("ID") ENABLE
/
ALTER TABLE  "VEICULOS" ADD FOREIGN KEY ("CLIENTES_ID")
	  REFERENCES  "CLIENTES" ("ID") ENABLE
/
ALTER TABLE  "SERVICOS" ADD FOREIGN KEY ("VISTORIAS_ID")
	  REFERENCES  "VISTORIAS" ("ID") ENABLE
/
ALTER TABLE  "ITENS" ADD CONSTRAINT "PRODUTOS_FK" FOREIGN KEY ("PRODUTOS_ID")
	  REFERENCES  "PRODUTOS" ("ID") ENABLE
/
ALTER TABLE  "COMPRAS_PRODUTOS" ADD CONSTRAINT "COMPRAS_FK" FOREIGN KEY ("COMPRAS_ID")
	  REFERENCES  "COMPRAS" ("ID") ENABLE
/
ALTER TABLE  "COMPRAS_PRODUTOS" ADD CONSTRAINT "COMPRAS_PRODUTOS_FK" FOREIGN KEY ("PRODUTOS_ID")
	  REFERENCES  "PRODUTOS" ("ID") ENABLE
/
CREATE OR REPLACE EDITIONABLE SYNONYM  "DBMS_XPLAN" FOR "LIVESQL"."ORACLE_SQL_USER_XPLAN"
/
CREATE OR REPLACE EDITIONABLE SYNONYM  "V$SESSION" FOR "LIVESQL"."ORACLE_SQL_USER_V$SESSION"
/
CREATE OR REPLACE EDITIONABLE SYNONYM  "V$SQL_PLAN_STATISTICS_ALL" FOR "LIVESQL"."ORACLE_SQL_USER_V$SQL_PLAN_S_A"
/





insert into clientes values(20,'leonardo@gmail.com','(27)99284-2301');
insert into clientes values(21,'rafael@gmail.com','(27)92332-2322');
insert into clientes values(22,'lucas@gmail.com','(27)99023-2133');
insert into clientes values(23,'renata@gmail.com','(27)92883-2121');
insert into clientes values(24,'miqueias@gmail.com','(27)98288-1922');
insert into clientes values(25,'cristiano@gmail.com','(27)99998-2332');



insert into clientes_pf values(20,'144.233.123-43','Leonardo','Gottardi');
insert into clientes_pf values(21,'213.515.214-23','Rafael','Santos');
insert into clientes_pf values(22,'123.424.123-23','Lucas','Silva');



insert into clientes_pj values(23,'CVC LTDA','1232.2133.12/0001');
insert into clientes_pj values(24,'Lanches LTDA','2312.2313.21/0001');
insert into clientes_pj values(25,'Cerâmicas LTDA','2312.1244.12/0001');


insert into veiculos values(50,'ABC-123','FIAT','UNO','1.0',123234,21);
insert into veiculos values(51,'ABC-456','VOLKSWAGEM','GOL','2.0',50000,22);
insert into veiculos values(52,'ABC-789','CHERY','QQ','2.0',30000,23);
insert into veiculos values(53,'BCD-123','AUDI','RS6','2.0',33123,20);
insert into veiculos values(54,'BCD-456','FIAT','TORO','3.0',12000,24);
insert into veiculos values(55,'BCD-789','FIAT','FORINO','1.0',10,25);



insert into funcionarios values(13,312,'Arthur','Miertschink','213.412.231-33','Atendente');
insert into funcionarios values(14,123,'Paulo','Solar','123.544.341-22','Mecânico');
insert into funcionarios values(17,544,'Pablo','Escobar','333.233.341-22','Mecânico');
insert into funcionarios values(15,233,'Tronte','End','111.222.333-32','Administrador');
insert into funcionarios values(16,553,'Adam','Smith','111.332.333-32','Administrador');



insert into vistorias values(1, 123312,TO_DATE('15/07/2017 20:00:00', 'DD/MM/YYYY HH24:MI:SS'),'Sem defeitos',51,13);
insert into vistorias values(2, 31233,TO_DATE('16/07/2017 20:30:00', 'DD/MM/YYYY HH24:MI:SS'),'Sem defeitos',50,13);
insert into vistorias values(3, 23123,TO_DATE('17/07/2017 21:43:00', 'DD/MM/YYYY HH24:MI:SS'),'risco na porta lateral traseira',53,13);
insert into vistorias values(4, 24114,TO_DATE('18/07/2017 20:43:00', 'DD/MM/YYYY HH24:MI:SS'),'Sem defeitos',52,13);
insert into vistorias values(5, 231312,TO_DATE('19/07/2017 19:43:00', 'DD/MM/YYYY HH24:MI:SS'),'Sem defeitos',54,13);
insert into vistorias values(6, 12442,TO_DATE('20/07/2017 15:43:00', 'DD/MM/YYYY HH24:MI:SS'),'janela esquerda trincada',55,13);



insert into fornecedores values(30,'12312.1414.12/23','Rei do Óleo','Rei');
insert into fornecedores values(31,'42141.4124.12/21','Pneusmonia','Pneus de mais');
insert into fornecedores values(32,'42141.2334.12/21','Peças Automotivas','Peças Automotivas');



insert into compras values(1,TO_DATE('14/06/2017 22:43:00', 'DD/MM/YYYY HH24:MI:SS'),1000,15,30);
insert into compras values(2,TO_DATE('19/06/2017 20:43:00', 'DD/MM/YYYY HH24:MI:SS'),2000,15,31);
insert into compras values(3,TO_DATE('20/07/2017 14:43:00', 'DD/MM/YYYY HH24:MI:SS'),3000,16,32);



insert into produtos values(3,'Óleo', 'Motum',45,'Fluidos');
insert into produtos values(4,'Pneu', 'Linglong',350,'Rodas');
insert into produtos values(5,'Volante', 'Strong',350,'Volantes');


insert into compras_produtos values(500,1,3);
insert into compras_produtos values(15,2,4);
insert into compras_produtos values(700,3,5);



insert into servicos values(501,TO_DATE('14/06/2017 11:43:00', 'DD/MM/YYYY HH24:MI:SS'),'Finalizado','Revisão','30 minutos',200,0,5,2);
insert into servicos values(502,TO_DATE('15/07/2017 10:43:00', 'DD/MM/YYYY HH24:MI:SS'),'Finalizado','Revisão','30 minutos',200,0,5,3);
insert into servicos values(503,TO_DATE('16/08/2017 15:43:00', 'DD/MM/YYYY HH24:MI:SS'),'Finalizado','Revisão','45 minutos',200,0,5,1);
insert into servicos values(504,TO_DATE('17/09/2017 16:43:00', 'DD/MM/YYYY HH24:MI:SS'),'Finalizado','Troca de peça','1 hora',500,0,5,4);
insert into servicos values(505,TO_DATE('19/10/2017 11:43:00', 'DD/MM/YYYY HH24:MI:SS'),'Finalizado','Revisão','25 minutos',230,0,4,6);
insert into servicos values(506,TO_DATE('23/11/2017 10:43:00', 'DD/MM/YYYY HH24:MI:SS'),'Finalizado','Troca de peça','1hora e 30 minutos',600,100,3,5);



insert into itens values(3, 501, 3);
insert into itens values(2, 502, 4);
insert into itens values(4, 503, 5);
insert into itens values(2, 504, 3);
insert into itens values(2, 505, 4);
insert into itens values(1, 506, 5);

insert into tarefas values( 14,504);
insert into tarefas values( 17,505);
insert into tarefas values( 14,502);
insert into tarefas values( 17,503);
insert into tarefas values( 17,501);
insert into tarefas values( 17, 506);
insert into tarefas values( 14, 506);




SELECT funcionarios.nome, funcionarios.sobrenome 
FROM 
clientes_pf, clientes, veiculos, vistorias, servicos, itens, produtos, compras_produtos, funcionarios, compras 
WHERE
clientes_pf.nome = 'Leonardo' 
and clientes_pf.id = clientes.id
and clientes.id = veiculos.clientes_id and
veiculos.id = vistorias.veiculos_id and
vistorias.id = servicos.vistorias_id and
servicos.id = itens.servicos_id and
itens.produtos_id = produtos.id and
produtos.id = compras_produtos.produtos_id and
compras_produtos.compras_id = compras.id and
compras.funcionarios_id = funcionarios.id;



SELECT 
funcionarios.nome, funcionarios.sobrenome
FROM
clientes_pj, clientes, veiculos, vistorias, servicos, tarefas, funcionarios
WHERE
clientes_pj.razao_social = 'CVC LTDA'
and clientes_pj.id = clientes.id 
and clientes.id = veiculos.clientes_id
and veiculos.id = vistorias.veiculos_id
and vistorias.id = servicos.vistorias_id
and servicos.id = tarefas.servicos_id
and tarefas.funcionarios_id = funcionarios.id

